# ==============================================================================
# Step 2: Create Label-Based GPU Placement
# ==============================================================================
# This Placement selects only clusters with the label accelerator=nvidia-tesla-t4.
# It is created in the Kueue Operator namespace on the hub cluster.
#
# The RHACM Admission Check Controller watches this Placement and dynamically
# generates a MultiKueueConfig based on the PlacementDecision.
#
# Usage:
#   oc apply -f 02-gpu-placement.yaml
#
# Reference:
#   https://github.com/open-cluster-management-io/ocm/tree/main/solutions/kueue-admission-check
# ==============================================================================
---
apiVersion: cluster.open-cluster-management.io/v1beta1
kind: Placement
metadata:
  name: multikueue-config-demo2
  namespace: openshift-kueue-operator
spec:
  clusterSets:
  - global
  tolerations:
  - key: cluster.open-cluster-management.io/unreachable
    operator: Exists
  - key: cluster.open-cluster-management.io/unavailable
    operator: Exists
  predicates:
    - requiredClusterSelector:
        labelSelector:
          matchLabels:
            accelerator: nvidia-tesla-t4
